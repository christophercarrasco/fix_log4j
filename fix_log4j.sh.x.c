#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f fix_log4j.sh -o fix_log4j 
#endif

static  char data [] = 
#define      date_z	1
#define      date	((&data[0]))
	"\364"
#define      opts_z	1
#define      opts	((&data[1]))
	"\157"
#define      shll_z	10
#define      shll	((&data[2]))
	"\216\203\160\345\215\161\041\322\140\257\214\037"
#define      tst1_z	22
#define      tst1	((&data[15]))
	"\361\207\043\255\333\274\251\270\164\136\325\101\217\266\012\027"
	"\352\203\306\240\165\031\170\151\172\033"
#define      xecc_z	15
#define      xecc	((&data[41]))
	"\163\177\163\247\161\321\362\127\103\166\245\237\103\236\331\244"
	"\374"
#define      pswd_z	256
#define      pswd	((&data[60]))
	"\110\266\335\374\133\011\016\044\035\147\325\177\012\312\060\376"
	"\355\007\220\242\235\032\230\014\021\144\022\036\217\174\316\353"
	"\347\100\350\102\111\366\147\146\135\074\346\150\007\026\146\364"
	"\036\366\227\273\020\057\310\042\223\332\100\043\126\016\017\075"
	"\116\367\200\227\356\347\376\114\043\345\264\052\374\033\036\032"
	"\021\265\325\042\345\235\104\171\167\204\234\316\223\253\013\341"
	"\242\214\171\221\163\170\335\227\135\222\301\131\255\340\163\277"
	"\226\111\341\173\347\045\364\136\252\220\055\075\073\070\037\336"
	"\305\230\160\070\021\116\317\156\340\221\310\215\161\074\115\007"
	"\206\056\202\155\124\167\314\377\007\371\074\103\062\134\042\367"
	"\365\222\057\006\340\377\165\301\220\076\117\001\172\234\011\001"
	"\312\213\156\037\002\072\036\012\063\133\116\146\267\160\135\254"
	"\002\215\262\343\214\047\244\034\145\363\036\340\217\047\341\132"
	"\263\120\171\266\212\227\300\276\362\017\044\251\177\202\126\202"
	"\017\010\145\234\060\012\271\226\375\327\167\215\377\131\350\262"
	"\251\141\151\063\371\052\362\354\071\027\225\270\231\354\073\251"
	"\364\240\105\351\374\002\224\372\276\076\320\361\165\246\176\224"
	"\056\263\025\040\035\217\074\171\365\221\354\361\236\371\331\347"
	"\260\266\321\254\271\146\247\167\244\170\151\031\036\347\255\115"
	"\232\302\156\270\122\252\061\107\073\036\071\332\027"
#define      msg1_z	65
#define      msg1	((&data[386]))
	"\311\222\164\202\370\034\372\235\224\143\266\263\137\006\250\266"
	"\246\015\033\360\234\333\260\271\132\232\134\171\101\116\346\140"
	"\363\123\311\314\072\230\034\236\315\103\264\253\333\343\117\041"
	"\356\353\066\103\032\004\250\002\254\334\345\360\312\214\056\101"
	"\206\011\341\026\105\163\136\323\216\037\112\050\040\112\144\000"
	"\345\047\157\235\171\031\316\301\124\354"
#define      chk2_z	19
#define      chk2	((&data[464]))
	"\060\357\316\042\007\372\174\326\217\165\120\267\226\071\367\225"
	"\126\037\056"
#define      inlo_z	3
#define      inlo	((&data[483]))
	"\313\244\055"
#define      text_z	3808
#define      text	((&data[976]))
	"\131\174\135\124\031\362\267\320\245\002\064\246\347\133\025\205"
	"\325\057\124\226\204\101\221\263\105\237\244\022\166\047\124\320"
	"\244\262\044\275\245\333\215\112\335\302\361\305\036\006\112\363"
	"\065\236\212\271\337\034\155\045\273\021\070\062\070\215\002\335"
	"\077\046\232\344\001\050\057\337\353\040\244\011\047\357\375\135"
	"\216\210\027\155\245\204\223\141\225\313\223\316\130\225\253\230"
	"\273\106\175\275\157\255\235\133\315\102\145\365\061\143\122\277"
	"\354\151\055\221\356\300\362\204\213\205\122\344\033\376\175\327"
	"\105\372\224\265\247\061\020\165\163\166\152\245\331\275\144\305"
	"\047\222\126\025\122\111\231\336\317\354\303\352\353\100\302\061"
	"\072\126\346\342\210\367\127\374\155\302\242\107\177\006\014\246"
	"\231\143\274\353\255\125\312\174\102\215\147\055\315\051\136\010"
	"\200\105\353\011\075\103\005\253\005\247\362\205\256\377\053\107"
	"\142\347\063\017\075\375\214\200\213\364\255\130\035\014\141\236"
	"\122\114\247\217\217\254\072\225\124\055\032\003\054\105\112\217"
	"\055\176\236\153\173\053\353\006\037\231\137\075\246\301\333\370"
	"\015\202\210\235\057\302\062\203\357\114\206\034\222\321\253\300"
	"\117\112\054\313\165\027\322\225\261\061\322\127\362\255\120\000"
	"\060\330\235\140\232\320\343\212\035\152\247\260\074\122\161\214"
	"\234\235\127\021\265\051\247\147\133\171\276\115\047\016\116\130"
	"\346\354\270\201\274\234\014\332\006\263\212\103\006\374\317\242"
	"\231\046\264\117\120\133\266\253\325\165\370\374\203\107\124\152"
	"\063\014\354\357\250\371\312\257\255\124\362\263\121\302\126\353"
	"\350\012\072\071\146\361\344\073\146\335\067\352\044\214\125\127"
	"\231\102\107\101\073\021\361\350\146\344\234\267\246\362\242\217"
	"\374\335\310\143\316\255\236\064\212\326\037\256\142\164\006\373"
	"\266\115\075\362\136\057\333\304\023\167\174\272\151\036\111\146"
	"\373\022\311\312\277\150\377\112\076\036\370\241\223\377\234\111"
	"\114\332\074\253\012\027\160\036\216\354\330\370\012\042\137\006"
	"\064\051\320\364\221\320\076\320\356\067\161\201\066\016\313\202"
	"\351\007\056\363\036\236\021\255\212\351\302\243\226\346\041\004"
	"\365\231\020\165\057\114\015\067\211\045\355\211\326\226\322\360"
	"\273\070\012\120\257\335\147\101\364\132\377\351\065\261\227\360"
	"\126\165\336\325\275\362\114\150\271\370\013\206\015\245\140\216"
	"\217\331\171\371\036\102\044\321\230\307\020\360\241\243\040\003"
	"\056\116\377\377\060\362\306\236\044\314\120\232\156\340\371\266"
	"\300\272\057\166\317\230\051\316\232\136\171\222\206\241\026\242"
	"\247\357\356\301\032\355\214\373\135\013\141\025\034\200\113\203"
	"\073\102\104\044\031\130\151\254\323\137\236\212\155\170\214\067"
	"\373\341\116\106\204\022\032\013\142\016\137\220\235\076\304\122"
	"\214\137\110\244\005\346\063\016\260\047\203\064\372\060\263\062"
	"\216\315\042\107\152\356\062\320\341\341\177\311\261\055\066\075"
	"\025\112\251\016\020\000\105\254\337\152\063\353\163\262\221\160"
	"\266\274\315\036\117\134\324\356\072\210\316\227\373\205\252\375"
	"\367\032\334\312\141\355\316\176\267\305\125\340\376\002\127\027"
	"\154\144\155\113\343\056\364\201\043\204\215\246\102\153\250\154"
	"\077\302\123\164\100\341\300\132\145\174\307\202\042\370\202\020"
	"\032\220\027\143\177\154\047\067\342\355\212\207\242\137\010\071"
	"\166\211\336\213\111\231\374\106\203\220\000\145\342\246\277\153"
	"\277\031\337\025\011\013\006\127\121\002\171\223\236\127\241\376"
	"\307\170\307\263\154\057\222\027\211\021\150\332\074\045\107\004"
	"\137\225\015\067\176\053\150\244\051\157\202\175\142\111\037\000"
	"\234\312\147\350\272\244\076\072\202\320\064\301\007\156\306\141"
	"\177\351\343\026\165\013\260\246\225\120\020\274\116\264\047\012"
	"\003\014\204\350\117\177\134\322\347\073\234\273\265\273\132\270"
	"\045\241\116\046\272\071\343\155\167\333\377\201\300\071\173\250"
	"\045\031\264\306\310\256\273\253\124\254\165\032\145\352\363\031"
	"\026\375\020\063\061\263\363\024\212\306\213\277\175\015\171\214"
	"\125\225\135\003\147\232\226\217\107\136\326\125\154\134\264\050"
	"\066\006\320\341\040\270\235\351\173\303\155\332\107\010\010\172"
	"\002\053\356\203\150\251\126\375\256\227\074\203\244\107\266\004"
	"\027\030\171\052\075\162\213\376\106\201\362\247\020\045\040\322"
	"\007\151\105\177\112\224\223\153\376\366\335\121\077\106\344\365"
	"\352\245\055\005\230\137\047\021\102\366\067\127\133\245\347\205"
	"\046\157\141\316\003\347\135\215\035\011\224\126\117\124\013\072"
	"\077\163\075\005\270\307\011\017\143\053\011\010\123\136\073\360"
	"\005\340\112\232\210\154\312\357\104\003\306\166\163\164\375\256"
	"\067\262\224\046\132\150\345\016\327\307\362\362\340\345\123\274"
	"\306\313\005\047\163\200\134\021\217\035\014\317\165\132\016\235"
	"\002\241\151\054\174\366\251\365\025\140\234\232\353\053\306\315"
	"\011\132\265\165\120\302\013\133\373\050\065\301\372\007\077\375"
	"\022\262\103\344\055\130\075\067\342\034\244\245\002\320\164\207"
	"\266\246\101\036\001\127\176\367\142\341\242\350\153\101\020\137"
	"\327\267\361\222\107\345\350\177\002\043\155\273\360\366\231\164"
	"\226\116\336\167\262\261\371\263\101\301\125\353\305\214\233\071"
	"\175\040\313\141\124\176\312\257\044\206\213\274\344\153\156\240"
	"\233\310\002\314\324\163\115\224\006\076\124\111\325\023\164\165"
	"\214\254\103\322\047\240\267\121\133\035\201\027\132\322\224\351"
	"\021\031\042\232\332\132\134\343\137\230\240\324\333\355\245\260"
	"\267\157\317\133\023\312\326\061\261\344\063\317\333\330\342\040"
	"\212\157\346\165\244\365\072\372\264\062\051\302\302\371\053\035"
	"\301\147\041\037\226\135\315\327\071\302\162\222\030\252\153\336"
	"\150\035\042\334\161\357\167\147\116\161\170\350\242\146\125\003"
	"\011\135\156\025\026\162\136\176\123\027\221\217\375\047\352\360"
	"\374\211\272\232\274\211\366\125\077\356\030\302\020\153\220\311"
	"\103\355\003\204\352\177\154\234\206\165\263\026\005\176\164\162"
	"\147\223\174\161\000\165\154\322\272\106\212\356\003\066\311\145"
	"\351\113\023\271\010\134\365\217\260\322\060\156\001\377\142\063"
	"\174\061\347\125\104\014\276\176\237\056\161\346\337\242\336\331"
	"\013\351\144\176\367\103\133\207\224\375\105\100\055\234\360\334"
	"\254\200\376\130\076\233\257\145\076\100\300\027\211\151\035\225"
	"\136\052\352\316\034\071\304\105\004\314\251\167\106\175\156\217"
	"\005\272\124\265\211\055\076\311\136\006\066\221\350\075\153\054"
	"\213\151\377\101\137\317\326\024\076\156\250\167\077\320\301\126"
	"\355\060\376\313\111\313\321\042\374\370\115\223\123\317\177\006"
	"\141\357\077\353\160\152\361\161\222\340\051\252\043\150\157\155"
	"\064\227\220\334\102\171\021\150\174\135\136\033\247\202\125\365"
	"\232\340\347\302\366\223\126\224\233\130\072\205\341\100\207\200"
	"\230\223\113\022\324\076\122\266\033\131\075\135\204\367\072\253"
	"\342\004\305\211\304\231\306\017\045\123\146\332\047\247\062\037"
	"\027\252\066\332\173\251\340\274\276\006\303\161\260\273\311\000"
	"\200\025\134\230\054\215\276\257\011\377\217\140\264\153\207\221"
	"\016\054\240\365\042\270\251\006\141\074\260\276\300\026\200\222"
	"\004\335\324\102\124\213\312\172\075\360\002\366\153\121\110\255"
	"\345\066\052\013\155\035\172\306\214\131\277\273\010\261\372\057"
	"\312\071\256\045\032\063\214\264\214\234\137\207\364\062\040\021"
	"\050\023\273\155\023\000\053\055\163\151\256\376\117\004\237\111"
	"\343\307\362\255\177\054\347\334\176\050\207\062\241\232\055\367"
	"\274\157\266\167\225\036\167\270\014\234\121\165\352\177\353\255"
	"\012\263\142\130\045\376\260\004\043\020\146\125\247\311\263\266"
	"\155\104\352\120\001\127\361\245\314\134\172\331\125\035\106\105"
	"\240\217\245\340\077\314\326\012\205\034\247\210\212\271\252\311"
	"\345\050\054\012\213\147\346\035\222\175\150\364\330\072\237\061"
	"\244\376\302\260\130\273\103\360\242\351\171\054\167\267\254\016"
	"\335\324\021\260\001\240\375\110\027\120\113\043\365\346\234\262"
	"\261\063\240\227\266\244\302\212\040\274\065\345\012\175\351\157"
	"\073\116\131\324\037\303\022\353\310\067\247\012\230\001\044\110"
	"\240\321\310\050\274\045\167\242\354\070\325\047\077\224\122\245"
	"\373\013\335\374\201\332\155\005\115\247\153\124\126\005\213\323"
	"\127\144\341\150\332\200\377\343\274\363\201\264\050\113\317\033"
	"\345\353\077\237\040\224\303\047\102\117\015\261\335\113\115\101"
	"\355\177\135\200\341\172\224\175\233\266\065\060\163\307\223\351"
	"\225\105\126\026\246\136\022\136\167\250\102\164\125\257\234\201"
	"\365\127\167\231\306\241\320\102\245\222\041\342\252\071\015\201"
	"\156\246\005\221\146\110\016\304\060\173\374\003\224\244\042\347"
	"\027\200\352\061\316\246\302\270\375\261\003\307\034\061\112\216"
	"\365\237\006\210\002\160\365\275\137\216\205\264\346\236\225\256"
	"\136\015\302\352\270\114\243\034\317\071\235\025\372\344\211\207"
	"\137\034\070\314\160\257\233\304\217\334\132\073\360\335\063\345"
	"\101\105\250\361\326\313\120\166\237\236\173\011\272\311\226\276"
	"\146\075\021\107\351\027\212\240\157\057\213\240\245\350\054\002"
	"\273\066\274\376\056\217\256\025\075\022\317\033\376\164\264\107"
	"\345\042\164\330\121\210\032\221\151\216\217\253\301\056\202\363"
	"\261\140\364\103\057\060\206\241\135\365\333\277\132\254\106\375"
	"\231\334\234\040\114\235\357\321\006\170\256\335\304\103\065\215"
	"\235\033\120\376\300\135\110\213\321\326\131\143\166\102\053\125"
	"\006\347\145\152\270\230\161\162\170\335\053\070\306\040\344\252"
	"\225\371\343\173\136\152\241\313\001\370\264\162\132\007\257\263"
	"\124\103\244\345\113\015\057\323\257\122\060\105\162\173\236\153"
	"\324\247\044\252\352\073\114\344\327\374\063\015\136\035\055\310"
	"\275\300\173\232\305\153\306\300\253\207\070\341\327\236\342\267"
	"\321\067\224\035\252\243\114\010\261\363\063\340\334\301\330\316"
	"\207\214\077\150\371\324\246\264\003\053\214\013\365\333\320\010"
	"\332\312\072\237\063\153\202\021\365\371\246\234\102\356\030\370"
	"\316\375\317\277\253\314\201\132\031\220\352\017\373\330\052\337"
	"\177\062\330\125\276\362\066\243\024\244\261\377\143\362\120\034"
	"\124\145\107\214\226\255\332\247\357\224\103\257\071\076\013\277"
	"\374\233\150\257\145\305\063\335\376\166\273\132\360\215\313\052"
	"\241\332\211\113\127\113\257\037\200\266\073\137\231\204\157\050"
	"\333\122\005\054\336\336\126\106\116\156\332\123\075\326\302\063"
	"\137\322\020\256\175\344\177\121\220\162\156\114\206\016\342\321"
	"\021\337\135\154\311\165\032\250\133\301\264\176\007\027\277\030"
	"\310\103\130\310\141\037\002\153\002\347\076\055\147\256\326\077"
	"\174\260\371\245\174\177\211\066\060\334\056\246\136\265\275\337"
	"\044\223\013\120\147\047\254\112\127\123\304\310\107\241\362\177"
	"\224\173\036\210\317\301\325\066\340\364\146\115\244\112\311\234"
	"\261\324\377\036\154\270\060\200\121\323\361\327\276\026\221\066"
	"\122\117\103\250\112\331\342\303\270\067\273\113\031\166\105\264"
	"\277\020\102\163\123\300\170\160\037\136\310\233\244\175\230\005"
	"\365\274\216\200\222\040\264\174\306\234\075\230\112\014\154\271"
	"\235\307\262\373\372\330\250\313\316\045\271\214\365\122\064\145"
	"\317\274\100\343\333\215\061\004\034\227\217\347\373\265\014\143"
	"\164\036\073\171\105\020\077\062\170\123\143\060\343\120\007\364"
	"\256\313\077\327\044\255\304\061\141\245\077\307\141\070\242\210"
	"\272\254\007\150\253\200\326\331\372\225\046\252\011\273\261\346"
	"\361\255\166\017\072\117\311\231\317\324\017\325\163\043\360\033"
	"\105\346\216\270\155\106\227\263\354\123\344\311\353\023\230\373"
	"\025\234\133\114\165\232\113\341\352\346\254\271\236\176\341\205"
	"\123\005\357\172\264\233\234\005\372\234\155\365\206\347\363\103"
	"\156\077\037\374\375\306\330\302\017\150\217\116\221\035\075\316"
	"\130\315\364\375\114\020\071\337\372\253\253\373\255\362\131\220"
	"\177\046\031\024\372\102\024\247\352\327\247\127\211\275\351\257"
	"\304\206\161\355\333\353\110\162\146\325\343\261\230\155\017\136"
	"\246\213\162\056\161\213\336\216\011\271\350\034\214\306\155\257"
	"\353\263\155\246\334\050\160\262\376\224\125\326\141\046\236\245"
	"\173\255\301\217\102\342\146\115\045\226\127\273\244\165\065\363"
	"\156\171\324\374\274\062\266\045\270\160\260\206\040\013\275\011"
	"\246\117\225\067\327\056\067\161\107\212\117\232\175\025\103\164"
	"\357\365\115\124\013\364\211\107\343\027\314\112\265\003\367\113"
	"\257\016\330\375\101\034\253\226\126\006\271\242\134\250\260\355"
	"\052\260\303\354\027\313\341\173\162\364\062\004\223\347\376\107"
	"\034\046\145\333\250\225\316\270\342\371\365\251\052\153\316\221"
	"\045\357\136\167\214\014\337\357\136\153\315\134\002\204\332\321"
	"\003\205\323\024\110\002\252\252\163\016\053\266\010\246\220\107"
	"\153\217\140\037\261\175\002\134\256\311\233\112\354\072\011\127"
	"\057\237\072\071\176\343\324\204\325\254\010\335\147\162\070\075"
	"\053\057\351\142\150\367\150\161\276\367\254\356\147\373\053\242"
	"\130\241\142\040\127\001\020\372\277\332\067\253\036\034\054\023"
	"\223\036\301\333\231\106\270\056\131\124\216\355\305\041\101\250"
	"\370\350\305\254\356\050\160\173\340\244\173\032\345\131\027\335"
	"\262\250\325\024\361\244\060\072\302\232\246\176\103\051\147\365"
	"\313\150\156\010\054\326\242\120\135\172\240\246\013\264\367\015"
	"\043\357\171\122\376\032\255\315\035\314\067\063\020\131\167\201"
	"\132\055\140\236\325\144\043\154\262\005\171\140\330\214\053\261"
	"\005\132\201\046\173\272\213\224\211\247\235\222\330\306\246\221"
	"\161\262\045\365\225\067\153\354\356\313\245\111\371\222\144\357"
	"\220\164\312\067\113\272\007\053\121\265\131\134\315\332\176\260"
	"\210\332\140\032\321\057\347\137\364\357\037\332\365\210\236\165"
	"\233\266\035\115\017\154\264\150\004\241\112\212\310\332\225\003"
	"\126\103\336\371\046\306\361\245\261\053\155\024\236\246\062\034"
	"\207\116\073\236\065\121\274\217\037\021\171\103\133\207\135\002"
	"\216\013\353\337\303\215\305\272\003\371\374\300\335\161\015\307"
	"\323\225\203\315\266\055\334\070\046\230\246\154\210\342\363\160"
	"\311\005\137\177\315\272\103\335\143\375\074\013\344\357\003\367"
	"\146\136\232\023\313\025\373\370\056\347\057\251\006\121\275\255"
	"\232\167\226\245\075\006\150\036\354\121\175\143\025\114\172\016"
	"\044\151\071\010\336\336\306\132\331\275\043\231\166\173\302\055"
	"\165\332\300\056\052\245\375\152\033\161\000\124\124\173\074\263"
	"\040\041\303\230\245\365\054\207\330\036\050\054\157\347\276\103"
	"\252\007\366\157\217\071\137\222\256\134\235\236\273\121\300\035"
	"\313\377\066\031\070\103\146\110\204\301\050\067\234\354\124\317"
	"\100\121\176\064\247\124\022\027\305\174\152\046\146\051\104\367"
	"\006\260\145\231\164\360\302\345\167\045\320\073\235\101\163\035"
	"\106\357\130\264\353\365\045\153\251\244\132\320\214\073\002\171"
	"\347\235\264\047\131\144\326\057\276\354\357\352\123\344\146\256"
	"\073\315\257\111\275\214\146\112\111\362\036\062\127\311\140\140"
	"\014\012\312\004\177\256\365\353\330\015\234\346\255\310\161\073"
	"\115\315\030\251\223\052\244\262\240\162\005\363\315\243\154\173"
	"\217\246\324\115\212\137\150\055\207\054\101\251\110\277\240\333"
	"\160\204\006\254\227\365\006\167\267\012\011\144\244\060\201\313"
	"\037\057\065\272\063\000\127\015\304\222\033\252\371\277\270\205"
	"\045\210\374\267\225\004\234\250\066\304\116\352\071\331\215\121"
	"\052\030\210\153\337\140\303\101\266\041\230\143\243\170\052\356"
	"\074\260\066\232\373\074\326\027\245\046\064\307\145\237\114\120"
	"\050\115\226\142\365\340\152\120\253\275\225\056\162\204\240\043"
	"\223\100\001\154\274\340\243\344\137\202\035\231\112\205\261\357"
	"\356\060\225\060\224\305\272\335\054\320\333\303\114\253\060\144"
	"\313\251\036\216\233\162\114\005\030\350\346\110\336\026\065\220"
	"\264\360\351\262\120\010\236\157\351\204\027\207\223\263\242\152"
	"\202\300\102\043\177\020\023\204\346\242\300\025\126\231\325\002"
	"\063\132\004\354\241\151\355\023\367\007\205\316\063\062\026\263"
	"\055\137\334\357\112\226\122\050\271\040\145\341\066\147\362\224"
	"\030\024\260\043\070\265\331\215\267\233\007\330\141\030\355\254"
	"\072\027\032\104\103\311\154\303\374\306\334\332\166\124\036\362"
	"\235\107\155\173\371\367\151\345\233\056\303\151\033\265\314\155"
	"\275\300\175\323\201\344\026\241\065\361\364\064\371\152\347\072"
	"\001\250\367\201\226\205\002\170\374\177\124\123\260\227\340\020"
	"\215\311\144\360\151\027\352\320\337\140\127\125\027\232\141\322"
	"\361\165\147\133\220\155\335\314\325\052\161\247\361\151\063\033"
	"\355\125\151\025\264\236\004\121\232\107\355\355\234\100\043\261"
	"\244\056\070\270\303\272\103\337\346\232\244\327\230\367\352\120"
	"\070\034\147\256\165\153\122\277\006\125\201\250\236\155\343\071"
	"\167\332\227\070\314\317\206\126\250\102\345\070\125\035\131\235"
	"\351\037\047\225\273\003\141\261\224\014\171\240\154\065\222\156"
	"\054\160\002\121\202\153\040\115\043\363\053\162\014\045\241\001"
	"\373\261\257\352\073\076\373\072\042\013\046\065\032\363\121\354"
	"\354\032\157\245\254\245\064\140\031\165\330\247\324\235\354\203"
	"\077\276\262\102\041\216\175\240\372\205\361\336\217\346\330\311"
	"\102\347\150\036\261\335\063\165\371\362\052\021\000\023\167\302"
	"\102\005\255\126\237\155\273\021\150\200\174\323\271\153\135\364"
	"\020\050\143\146\200\010\251\327\245\220\321\337\021\045\331\331"
	"\075\137\200\330\361\015\237\177\076\014\220\072\253\065\372\227"
	"\137\130\060\356\133\301\277\173\146\054\140\042\101\131\306\273"
	"\316\057\333\306\012\332\253\141\277\143\026\137\231\301\064\274"
	"\171\276\370\326\216\316\152\205\217\323\314\101\300\173\167\034"
	"\262\127\227\304\247\226\070\176\126\264\152\131\246\104\054\022"
	"\071\017\156\143\207\361\116\345\111\060\100\122\255\274\277\234"
	"\030\202\143\211\171\134\340\176\337\137\242\271\165\256\125\270"
	"\311\012\361\365\310\100\105\242\165\124\356\040\273\355\321\056"
	"\010\024\146\137\077\150\057\377\066\267\367\010\236\000\134\236"
	"\230\242\325\024\317\034\244\063\155\141\347\230\303\134\043\170"
	"\251\216\265\317\121\111\061\352\361\201\304\042\264\017\114\072"
	"\331\025\304\255\264\246\105\306\062\224\254\151\025\124\264\257"
	"\105\123\254\023\022\117\065\343\140\374\312\006\245\160\040\212"
	"\105\340\126\111\333\330\347\220\175\213\273\114\015\075\117\150"
	"\370\310\215\043\260\257\346\225\133\230\237\363\151\222\164\125"
	"\120\327\203\051\362\155\273\311\314\167\123\134\361\342\271\267"
	"\263\371\210\124\335\113\305\272\152\251\221\010\333\260\027\347"
	"\157\311\140\073\270\375\315\311\126\166\246\225\013\005\234\100"
	"\057\155\064\300\075\163\221\053\252\002\255\340\020\170\143\371"
	"\200\221\354\237\057\376\114\271\347\363\117\363\370\353\064\050"
	"\130\150\351\226\334\172\302\206\174\157\146\215\350\312\207\150"
	"\133\164\010\212\162\125\104\132\110\224\115\101\200\201\151\331"
	"\352\122\157\307\314\061\115\111\240\264\327\211\176\136\362\331"
	"\322\372\144\104\117\251\236\227\075\354\330\275\156\102\226\131"
	"\225\005\040\142\067\155\253\330\041\202\141\237\341\123\171\263"
	"\115\335\367\235\206\226\065\304\202\016\201\361\120\030\112\345"
	"\036\152\107\125\330\363\055\372\166\217\231\127\342\023\013\060"
	"\361\002\316\170\231\003\074\034\021\276\015\142\326\127\110\365"
	"\302\217\113\232\203\170\224\371\010\056\121\353\101\134\033\063"
	"\137\352\253\370\355\347\024\377\246\042\141\174\171\251\162\074"
	"\071\275\327\274\066\153\266\076\232\010\051\334\145\105\017\304"
	"\057\272\275\035\242\322\034\110\364\176\305\156\050\067\253\141"
	"\364\202\036\053\355\325\151\210\336\222\144\103\330\164\007"
#define      lsto_z	1
#define      lsto	((&data[5029]))
	"\210"
#define      chk1_z	22
#define      chk1	((&data[5034]))
	"\102\031\215\300\065\131\246\133\347\171\047\033\104\163\350\056"
	"\237\357\006\130\153\177\263\015\323\245\336\373\351"
#define      msg2_z	19
#define      msg2	((&data[5062]))
	"\012\051\151\050\255\055\220\211\111\276\237\051\255\152\261\256"
	"\144\054\345\276\035\351\065"
#define      rlax_z	1
#define      rlax	((&data[5082]))
	"\145"
#define      tst2_z	19
#define      tst2	((&data[5083]))
	"\333\022\256\277\336\255\212\166\050\110\046\005\272\236\277\322"
	"\225\252\137"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
